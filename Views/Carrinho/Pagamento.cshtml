<link rel="stylesheet" type="text/css" href="~/assets/css/Carrinho/pagamento.css" />
@model kuarasy.Models.Entidades.Compra
@{
    ViewData["Title"] = "Pagamento";
}

<div class="container my-5">
    <main role="main" class="flex-shrink-0">
        <h2 class="fw-bolder"> Finalização do pedido</h2>
        <div class="row g-3">
            <div class="col my-5">
                <div class="card">
                    <div class="card-body px-5">
                        <h5 class="card-title my-4">Endereço de entrega</h5>
                        <form class="row justify-content-center">
                            <div>
                                <input type="text" class="form-control mb-4" id="cep" placeholder="CEP">
                                <input type="text" class="form-control mb-4" id="endereco" placeholder="Endereço">
                                <input type="text" class="form-control mb-4" id="bairro" placeholder="Bairro">
                                <input type="text" class="form-control mb-4" id="numero" placeholder="Numero">
                            </div>

                            <div class="d-flex justify-content-end">
                                <button type="submit" class="btn btn-red mb-3">Salvar</button>
                            </div>
                        
                        </form>
                    </div>

                </div>

                <div class="card my-5 bg-red-medium text-light shadow">
                    <div class="card-body ms-4">
                    <div class="table-responsive">
                        <table class="table table-borderless my-3">
                            <thead>
                                <tr class="text-light">
                                    <th>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault1" aria-describedby="checkHelp1">
                                            <label class="form-check-label fw-bolder" for="flexRadioDefault1">
                                                Frete Fixo
                                            </label>
                                            <div id="checkHelp1" class="form-text text-light">Chega entre 3 a 6 dias úteis</div>
                                        </div>
                                        
                                    </th>
                                
                                    <th class="align-top ">R$12,00</th>  
                                </tr>
                            </thead>
                            
                            
                            <tr class="text-light">
                                 <td>
                                     <div class="form-check">
                                        <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault2" aria-describedby="checkHelp2">
                                        <label class="form-check-label fw-bolder" for="flexRadioDefault2">
                                            Correios
                                        </label>
                                        <div id="checkHelp2" class="form-text text-light fw-bolder">Chega entre 3 e 5 dias úteis</div>
                                     </div>
                                    
                                </td>
                                <td class="fw-bolder">R$12,00</td>
                            </tr>
                        </table>
                    </div>

                    </div>

                </div>

            </div>

            <div class="col my-5 ms-4">
                <div class="row card mb-5">
                    <div class="card-body px-5">
                        <h5 class="card-title my-4"> Informações pessoais</h5>
                        <div class="row">
                            <span class="d-flex">Contato: <p class="ms-2 text-muted"> usuario@email.com</p> </span>
                            <span class="d-flex">Nome: <p class="ms-2 text-muted"> Usuario Sobrenome</p> </span>
                            <span class="d-flex">CPF: <p class="ms-2  text-muted"> 456.789.123-00</p> </span>
                            <span class="d-flex">Telefone: <p class="ms-2 text-muted"> (11) 99999-9999</p></span>
                        </div>
                    </div>
                </div>

                <form class="row">
                    <div class="card">
                        <div class="card-body px-5">
                            <h5 class="card-title my-4"> Pagamento</h5>
                                <div class="row mb-3">
                                    <div class="col-sm-12">
                                        <div class="form-group">
                                            <label for="name">Nome do titular</label>
                                            <input class="form-control my-2" id="name" type="text" placeholder="FULANO A SILVA">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="row mb-3">
                                    <div class="col-sm-12">
                                        <div class="form-group">
                                            <label for="ccnumber">Número do cartão</label>
                                            <div class="input-group my-2">
                                                <input class="form-control" type="text" placeholder="0000 0000 0000 0000" autocomplete="email">
                                                <div class="input-group-append">
                                                    <span class="input-group-text" style="font-size:1.5rem;" ><i class="fas fa-credit-card"></i></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            <div class="row mb-3">
                                <div class="form-group col-sm-4">
                                    <label for="ccmonth">Mês</label>
                                    <select class="form-control my-2" id="ccmonth">
                                        <option>1</option>
                                        <option>2</option>
                                        <option>3</option>
                                        <option>4</option>
                                        <option>5</option>
                                        <option>6</option>
                                        <option>7</option>
                                        <option>8</option>
                                        <option>9</option>
                                        <option>10</option>
                                        <option>11</option>
                                        <option>12</option>
                                    </select>
                                </div>
                                <div class="form-group col-sm-4">
                                    <label for="ccyear">Ano</label>
                                    <select class="form-control my-2" id="ccyear">
                                        <option>2022</option>
                                        <option>2023</option>
                                        <option>2024</option>
                                        <option>2025</option>
                                        <option>2026</option>
                                        <option>2027</option>
                                        <option>2028</option>
                                        <option>2029</option>
                                        <option>2030</option>
                                        <option>2031</option>
                                        <option>2032</option>
                                    </select>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label for="cvv">CVV/CVC</label>
                                        <input class="form-control my-2" id="cvv" type="text" placeholder="123">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="d-flex justify-content-end px-5 mb-4">
                            <button class="btn btn-success float-right" type="submit" onsubmit="" >Confirmar</button>
                        </div>
                    </div>
                </form>
              
                <form asp-action="Pagamento" method="post">
                    <div class = "">
                        <textarea asp-for="Observacao" id="nome" class="form-control"></textarea>
                        <input asp-for="Valor_total" id="total"  class="form-control"/>
                        <input asp-for="QuantidadeComprado" id="quantidadeComprado" class="form-control" />
                        <input asp-for="Quantidade" id="quantidade" class="form-control" />
                        <input asp-for="Id_produtos" id="idProduto" class="form-control" />
                    </div>
                     <div class="row  my-3">
                    <button onclick="Produto.limparCarrinho()" class="btn bg-yellow text-light mb-3 rounded-3 fw-bolder shadow" type="submit"> Finalizar pedido</button>
                    </div>
                </form>
                    

               

            </div>

            <div class="d-flex justify-content-start my-3">
                    <a class="btn btn-yellow" asp-area="" asp-controller="Carrinho" asp-action="Index"> Voltar</a>
            </div>

        </div>


        
    </main>
</div>

<script>

    const Storage = {
		get() {
			return JSON.parse(localStorage.getItem("Carrinho")) || []
		},
		set(produtos) {
			localStorage.setItem("Carrinho", JSON.stringify(produtos))
		}
	}

    const Produto = {
        all: Storage.get(),
        inserir(){
            Produto.all.forEach(produto => {
                document.getElementById('nome').value += produto.nome+": "+produto.quantidadePadrao+"\n"
                document.getElementById('total').value = Utils.formatCurrency(Produto.total())
                document.getElementById('quantidadeComprado').value += produto.quantidadePadrao+","
                document.getElementById('idProduto').value += produto.id+","
                document.getElementById('quantidade').value += produto.quantidade+","       
			})
        },
        total() {
			let expense = 0
			Produto.all.forEach(produto => {
			expense += produto.preco 
			})
			return expense
		},
        limparCarrinho(){
            localStorage.clear(Produto.all)
        }
    }
    const Utils = {
		formatCurrency(value) {
			value = String(value).replace(",", "")
			value = Number(value) / 100
			value = value.toLocaleString("pt-BR", {
				style: "currency",
				currency: "BRL"
			})
			return value
		},
	}

    Produto.inserir()
</script>
